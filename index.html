<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Visualizer</title>
    <!-- Include the stylesheets you need for the Views components -->
    <!-- See https://developer.spotify.com/technologies/apps/docs/preview/views/ -->
    <link rel="stylesheet" href="$views/css/image.css">
    <link rel="stylesheet" href="$views/css/list.css">
    <link rel="stylesheet" href="$views/css/buttons.css">
    <!-- <link rel="stylesheet" href="$views/css/throbber.css"> -->
    <link rel="stylesheet" href="css/style.css">
    <!-- If you are using the preview SDK for webplayer then uncomment the script below -->
    <!--script src="http://d1hza3lyffsoht.cloudfront.net/preview-sdk/bootstrap.js"></script-->
  </head>
  <body>
    <h1></h1>
    
	<script src="https://github.com/downloads/processing-js/processing-js/processing-1.4.1.js"></script>
	<script type="text/processing" data-processing-target="pjs">

	// the number of FFT bands we want to receive
	int numberOfBands = 32;
	// if we don't create a getter like this, we will not
	// be able to retrieve sketch.numberOfBands from the external js
	int numberOfBands(){
		return numberOfBands;
	}
	
	// this array will hold the audio data
	float[] fft = new float[numberOfBands];

	void setup(){
		// I've noticed that performance degrades quickly with a larger canvas
		size( 500, 350 );
		background(0);
		frameRate(60);
	}
	
	// call this method from within the audio data callback
	void updateData(float[] newFFT){
		fft = newFFT;
	}
	
	// draw the bars
	void draw(){
		background(0);
		float barWidth = ceil(width / (float)numberOfBands);

		beginShape();
		vertex(0, height);
		for(int i = 0; i < numberOfBands; i++){
			float x = i * barWidth;
			float y = height;
			float w = barWidth;
			float h = map(fft[i], -100, 10, 0, -height);	// audio data seems to have about this range

			vertex(x, y + h);
			vertex(x + w, y + h);
		}
		vertex(width, height);
		endShape();
	}
	</script>
	<canvas id="pjs"></canvas>
    
    <script src="scripts/main.js"></script>
  </body>
</html>
